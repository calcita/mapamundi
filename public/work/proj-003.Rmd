---
title: "recorrido"
output: html_document
runtime: shiny
---
![Mapa](img/work/proj-003/thumb.jpg)
```{r, echo=FALSE}

City=c("Augsburgo","Barcelona","Berlin","Burgas","Coimbra","Deutschlandsberg","Dresde","Dubrovnik","Eltendorf","Graz","Heidelberg","Himara","Kotor","Lisboa","Liubliana","Londres","Madrid","Maribor","Múnich","Porto","Saranda","Sofia","Split","Tesalónica","Tirana","Trogir","Varna","Viena","Vlora","Zagreb")

days_city=c(1,3,38,1,3,17,5,1,22,4,2,3,3,17,5,18,5,2,3,5,3,3,1,4,2,3,2,3,2,5)

Latitude=c(48.366512,41.385064,52.520008,42.510578,40.2098,46.81595,51.050407,42.650661,47.008797,47.076668,49.39875,40.103472,42.424662,38.7086,46.056946,51.5073509,40.416775,46.55465,48.137154,41.1579438,39.859212,42.698334,43.508133,40.736851,41.327953,43.516387,43.204666,48.210033,40.466067,45.815399)

Longitude=c(10.894446,2.173403,13.404954,27.461014,-8.4303,15.21338,13.737262,18.094424,16.202751,15.421371,8.672434,19.750238,18.771234,-9.1351,14.505751,-0.1277583,-3.70379,15.645881,11.576124,-8.6291053,20.0271,23.319941,16.440193,22.920227,19.819025,16.250189,27.910543,16.363449,19.491356,15.966568)

radio=c(5000,5000,10000,5000,5000,8000,7000,5000,8000,5000,5000,5000,5000,8000,7000,8000,7000,5000,5000,7000,5000,5000,5000,5000,5000,5000,5000,5000,5000,7000)

city=data.frame(cbind(City,days_city,Latitude,Longitude,radio))

#city=read.csv("city_circulo.csv")
#table(city$City)
 library(shiny)
 library(leaflet)
  
  
 ui <- fluidPage(  titlePanel(""),
                        mainPanel(
                       leafletOutput("mymap")
                    ))
  
  server <- function(input, output, session) {
            output$mymap <- renderLeaflet({
      
  m <- leaflet() %>% 
       addTiles() %>%
  
      addCircleMarkers(lng=city$Longitude,lat=city$Latitude, radius =city$days_city/2,popup=paste0(city$City,": ",city$days_city," días"),color="green")
  

 })
  }

shinyApp(ui, server)
```

## Ciudades Visitadas

Algo

```{r, echo=FALSE}
library(dplyr)
library(plotly)
categories=c("Alojamiento","Comida","Seguro de viaje","Transporte inter-ciudades","Transporte Urbano")
porcentaje=c(32.5,25.9,6.9,28.7,6.0)
averageww=c(13.5,10.8,NA,NA,NA)
average=c(10.8,8.6,2.3,9.5,2.0)
tab=data.frame(cbind(categories,porcentaje,averageww,average))
tab=tab[order(tab$porcentaje,decreasing=F),]
verdoso=c("#66c2a4","#2ca25f","#006d2c","#b2e2e2","99d8c8")

p <- plot_ly(tab, labels= ~categories,values=~porcentaje,type="pie",
             textposition = 'inside',
             textinfo = 'label+percent',
             insidetextfont = list(color = '#FFFFFF'),
             hoverinfo = 'text',
             text = ~paste(average, 'euros, promedio diario.'),
             marker = list(colors = verdoso,
                           line = list(color = '#FFFFFF', width = 1)),
             showlegend = FALSE) %>%
  layout(title = 'Porcentaje de gastos según categorías y promedio diario en euros',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
 
print(p)
```


ffdg 


```{r, echo=FALSE}
# m <- leaflet() %>% 
 #      addTiles() %>%
 #m
#setwd("/home/calcita/myblog/mapamundi/mapamundi/public/img/work/proj-003/")
#library(leaflet)
#citys=read.csv("city_latlon.csv")  
#citys=citys[-1,]

#table(citys$City)
#### Mapa ciudades visitadas por bimestre ####
#ikono <- iconList(makeIcon("amarillo.png", iconWidth = 16, iconHeight =20),
#                  makeIcon("verde.png", iconWidth = 16, iconHeight =20),
#
#makeIcon("rojo.png", iconWidth = 16, iconHeight =20))

#m<-leaflet() %>%
#  addTiles()%>%
#  #setView(m,lng=8.5508,lat=45.9223,zoom=4)%>%
#  #setMaxBounds(m,lng1=-12.041,lng2=46.770,lat1=60.436,lat2=35.317)%>%
  
#  addMarkers(lng=citys$Longitude[1:20],lat=citys$Latitude[1:20], data=citys,popup=~City[1:20], icon=ikono[1], #group = "jun-jul") %>%
#  addMarkers(lng=citys$Longitude[21:33],lat=citys$Latitude[21:33], data=citys,popup=~City[21:33], #icon=ikono[2], group = "ago-set") %>%
#  addMarkers(lng=citys$Longitude[34:nrow(citys)],lat=citys$Latitude[34:nrow(citys)], #data=citys,popup=~City[34:nrow(citys)], icon=ikono[3], group = "oct-nov") %>%

#  addLegend("bottomleft",colors = c("red","green","#feb24c"), labels = c("jun-jul","ago-set","oct-nov"), #opacity = 1) %>%
  
#  addLayersControl(
#    overlayGroups =  c("jun-jul","ago-set","oct-nov"),
#    options = layersControlOptions(collapsed = FALSE)
#  )

#m
```

